{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect, useContext } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Axios from 'axios';\nimport { AuthContext } from \"../context/authorization\";\nimport FooterMenu from \"../components/Menu\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nvar AllRequestsScreen = function AllRequestsScreen(_ref) {\n  var _state$user;\n  var navigation = _ref.navigation;\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    requests = _useState2[0],\n    setRequests = _useState2[1];\n  var _useContext = useContext(AuthContext),\n    _useContext2 = _slicedToArray(_useContext, 1),\n    state = _useContext2[0];\n  var userId = state == null ? void 0 : (_state$user = state.user) == null ? void 0 : _state$user._id;\n  useEffect(function () {\n    var fetchRequests = function () {\n      var _ref2 = _asyncToGenerator(function* () {\n        try {\n          var response = yield Axios.get(`/auth/allrequests/${userId}`);\n          setRequests(response.data);\n        } catch (error) {\n          console.error('Error fetching requests:', error);\n        }\n      });\n      return function fetchRequests() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    fetchRequests();\n  }, []);\n  var acceptRequest = function () {\n    var _ref3 = _asyncToGenerator(function* (requestId) {\n      console.log('Accepting request:', userId, requestId);\n      try {\n        yield Axios.post('/auth/acceptFriendReq', {\n          senderId: userId,\n          receiverId: requestId\n        });\n        setRequests(function (prevRequests) {\n          return prevRequests.filter(function (request) {\n            return request._id !== requestId;\n          });\n        });\n      } catch (error) {\n        console.error('Error accepting request:', error);\n      }\n    });\n    return function acceptRequest(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  return _jsxs(_Fragment, {\n    children: [_jsxs(View, {\n      style: styles.container,\n      children: [_jsx(Text, {\n        style: styles.header,\n        children: \"Friend Requests\"\n      }), requests.length === 0 ? _jsx(Text, {\n        children: \"You have no friend requests.\"\n      }) : _jsx(FlatList, {\n        data: requests,\n        keyExtractor: function keyExtractor(item) {\n          return item._id;\n        },\n        renderItem: function renderItem(_ref4) {\n          var item = _ref4.item;\n          return _jsxs(View, {\n            style: styles.requestContainer,\n            children: [_jsx(Image, {\n              source: {\n                uri: item.avatar\n              },\n              style: styles.profileImage\n            }), _jsxs(Text, {\n              style: styles.requestName,\n              children: [item.name, \" \"]\n            }), _jsx(TouchableOpacity, {\n              style: styles.acceptButton,\n              onPress: function onPress() {\n                return acceptRequest(item._id);\n              },\n              children: _jsx(Text, {\n                style: styles.buttonText,\n                children: \"Accept\"\n              })\n            })]\n          });\n        }\n      })]\n    }), _jsx(FooterMenu, {})]\n  });\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    padding: 16\n  },\n  header: {\n    fontSize: 18,\n    fontWeight: 'bold',\n    marginBottom: 16\n  },\n  requestContainer: {\n    flexDirection: 'row',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    marginBottom: 16\n  },\n  requestName: {\n    fontSize: 16\n  },\n  acceptButton: {\n    backgroundColor: 'green',\n    padding: 8,\n    borderRadius: 8\n  },\n  declineButton: {\n    backgroundColor: 'red',\n    padding: 8,\n    borderRadius: 8\n  },\n  buttonText: {\n    color: 'white',\n    fontWeight: 'bold'\n  },\n  profileImage: {\n    width: 60,\n    height: 60,\n    borderRadius: 30\n  }\n});\nexport default AllRequestsScreen;","map":{"version":3,"names":["React","useState","useEffect","useContext","View","Text","FlatList","TouchableOpacity","StyleSheet","Image","Axios","AuthContext","FooterMenu","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AllRequestsScreen","_ref","_state$user","navigation","_useState","_useState2","_slicedToArray","requests","setRequests","_useContext","_useContext2","state","userId","user","_id","fetchRequests","_ref2","_asyncToGenerator","response","get","data","error","console","apply","arguments","acceptRequest","_ref3","requestId","log","post","senderId","receiverId","prevRequests","filter","request","_x","children","style","styles","container","header","length","keyExtractor","item","renderItem","_ref4","requestContainer","source","uri","avatar","profileImage","requestName","name","acceptButton","onPress","buttonText","create","flex","padding","fontSize","fontWeight","marginBottom","flexDirection","justifyContent","alignItems","backgroundColor","borderRadius","declineButton","color","width","height"],"sources":["D:/React-Native/chat/client/screens/AllRequest.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\r\nimport { View, Text, FlatList, TouchableOpacity, StyleSheet, Image } from 'react-native';\r\nimport Axios from 'axios';\r\nimport { AuthContext } from '../context/authorization';\r\nimport FooterMenu from '../components/Menu';\r\n\r\nconst AllRequestsScreen = ({ navigation }) => {\r\n    const [requests, setRequests] = useState([]);\r\n    const [state] = useContext(AuthContext);\r\n    const userId = state?.user?._id;\r\n\r\n    useEffect(() => {\r\n        const fetchRequests = async () => {\r\n            try {\r\n                const response = await Axios.get(`/auth/allrequests/${userId}`);\r\n                setRequests(response.data);\r\n            } catch (error) {\r\n                console.error('Error fetching requests:', error);\r\n            }\r\n        };\r\n\r\n        fetchRequests();\r\n    }, []);\r\n\r\n    const acceptRequest = async (requestId) => {\r\n        console.log('Accepting request:', userId, requestId);\r\n        try {\r\n           \r\n            await Axios.post('/auth/acceptFriendReq', { senderId: userId, receiverId: requestId });\r\n            // Remove the accepted request from the requests state\r\n            setRequests(prevRequests => prevRequests.filter(request => request._id !== requestId));\r\n        } catch (error) {\r\n            console.error('Error accepting request:', error);\r\n        }\r\n    };\r\n    \r\n\r\n\r\n\r\n    return (\r\n        <>\r\n            <View style={styles.container}>\r\n                <Text style={styles.header}>Friend Requests</Text>\r\n                {requests.length === 0 ? (\r\n                    <Text>You have no friend requests.</Text>\r\n                ) : (\r\n                    <FlatList\r\n                        data={requests}\r\n                        keyExtractor={(item) => item._id}\r\n                        renderItem={({ item }) => (\r\n                            <View style={styles.requestContainer}>\r\n                                <Image source={{ uri: item.avatar }} style={styles.profileImage} />\r\n                                <Text style={styles.requestName}>{item.name} </Text>\r\n                                <TouchableOpacity\r\n                                    style={styles.acceptButton}\r\n                                    onPress={() => acceptRequest(item._id)}\r\n                                >\r\n                                    <Text style={styles.buttonText}>Accept</Text>\r\n                                </TouchableOpacity>\r\n                            </View>\r\n                        )}\r\n                    />\r\n                )}\r\n\r\n            </View>\r\n            <FooterMenu />\r\n        </>\r\n\r\n    );\r\n};\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        flex: 1,\r\n        padding: 16,\r\n    },\r\n    header: {\r\n        fontSize: 18,\r\n        fontWeight: 'bold',\r\n        marginBottom: 16,\r\n    },\r\n    requestContainer: {\r\n        flexDirection: 'row',\r\n        justifyContent: 'space-between',\r\n        alignItems: 'center',\r\n        marginBottom: 16,\r\n    },\r\n    requestName: {\r\n        fontSize: 16,\r\n    },\r\n    acceptButton: {\r\n        backgroundColor: 'green',\r\n        padding: 8,\r\n        borderRadius: 8,\r\n    },\r\n    declineButton: {\r\n        backgroundColor: 'red',\r\n        padding: 8,\r\n        borderRadius: 8,\r\n    },\r\n    buttonText: {\r\n        color: 'white',\r\n        fontWeight: 'bold',\r\n    },\r\n    profileImage: {\r\n        width: 60,\r\n        height: 60,\r\n        borderRadius: 30,\r\n    }\r\n});\r\n\r\nexport default AllRequestsScreen;\r\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,UAAU,QAAQ,OAAO;AAAC,OAAAC,IAAA;AAAA,OAAAC,IAAA;AAAA,OAAAC,QAAA;AAAA,OAAAC,gBAAA;AAAA,OAAAC,UAAA;AAAA,OAAAC,KAAA;AAE/D,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,WAAW;AACpB,OAAOC,UAAU;AAA2B,SAAAC,GAAA,IAAAC,IAAA;AAAA,SAAAC,IAAA,IAAAC,KAAA;AAAA,SAAAC,QAAA,IAAAC,SAAA;AAE5C,IAAMC,iBAAiB,GAAG,SAApBA,iBAAiBA,CAAAC,IAAA,EAAuB;EAAA,IAAAC,WAAA;EAAA,IAAjBC,UAAU,GAAAF,IAAA,CAAVE,UAAU;EACnC,IAAAC,SAAA,GAAgCtB,QAAQ,CAAC,EAAE,CAAC;IAAAuB,UAAA,GAAAC,cAAA,CAAAF,SAAA;IAArCG,QAAQ,GAAAF,UAAA;IAAEG,WAAW,GAAAH,UAAA;EAC5B,IAAAI,WAAA,GAAgBzB,UAAU,CAACQ,WAAW,CAAC;IAAAkB,YAAA,GAAAJ,cAAA,CAAAG,WAAA;IAAhCE,KAAK,GAAAD,YAAA;EACZ,IAAME,MAAM,GAAGD,KAAK,qBAAAT,WAAA,GAALS,KAAK,CAAEE,IAAI,qBAAXX,WAAA,CAAaY,GAAG;EAE/B/B,SAAS,CAAC,YAAM;IACZ,IAAMgC,aAAa;MAAA,IAAAC,KAAA,GAAAC,iBAAA,CAAG,aAAY;QAC9B,IAAI;UACA,IAAMC,QAAQ,SAAS3B,KAAK,CAAC4B,GAAG,CAAE,qBAAoBP,MAAO,EAAC,CAAC;UAC/DJ,WAAW,CAACU,QAAQ,CAACE,IAAI,CAAC;QAC9B,CAAC,CAAC,OAAOC,KAAK,EAAE;UACZC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;QACpD;MACJ,CAAC;MAAA,gBAPKN,aAAaA,CAAA;QAAA,OAAAC,KAAA,CAAAO,KAAA,OAAAC,SAAA;MAAA;IAAA,GAOlB;IAEDT,aAAa,CAAC,CAAC;EACnB,CAAC,EAAE,EAAE,CAAC;EAEN,IAAMU,aAAa;IAAA,IAAAC,KAAA,GAAAT,iBAAA,CAAG,WAAOU,SAAS,EAAK;MACvCL,OAAO,CAACM,GAAG,CAAC,oBAAoB,EAAEhB,MAAM,EAAEe,SAAS,CAAC;MACpD,IAAI;QAEA,MAAMpC,KAAK,CAACsC,IAAI,CAAC,uBAAuB,EAAE;UAAEC,QAAQ,EAAElB,MAAM;UAAEmB,UAAU,EAAEJ;QAAU,CAAC,CAAC;QAEtFnB,WAAW,CAAC,UAAAwB,YAAY;UAAA,OAAIA,YAAY,CAACC,MAAM,CAAC,UAAAC,OAAO;YAAA,OAAIA,OAAO,CAACpB,GAAG,KAAKa,SAAS;UAAA,EAAC;QAAA,EAAC;MAC1F,CAAC,CAAC,OAAON,KAAK,EAAE;QACZC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;MACpD;IACJ,CAAC;IAAA,gBAVKI,aAAaA,CAAAU,EAAA;MAAA,OAAAT,KAAA,CAAAH,KAAA,OAAAC,SAAA;IAAA;EAAA,GAUlB;EAKD,OACI3B,KAAA,CAAAE,SAAA;IAAAqC,QAAA,GACIvC,KAAA,CAACZ,IAAI;MAACoD,KAAK,EAAEC,MAAM,CAACC,SAAU;MAAAH,QAAA,GAC1BzC,IAAA,CAACT,IAAI;QAACmD,KAAK,EAAEC,MAAM,CAACE,MAAO;QAAAJ,QAAA,EAAC;MAAe,CAAM,CAAC,EACjD7B,QAAQ,CAACkC,MAAM,KAAK,CAAC,GAClB9C,IAAA,CAACT,IAAI;QAAAkD,QAAA,EAAC;MAA4B,CAAM,CAAC,GAEzCzC,IAAA,CAACR,QAAQ;QACLiC,IAAI,EAAEb,QAAS;QACfmC,YAAY,EAAE,SAAAA,aAACC,IAAI;UAAA,OAAKA,IAAI,CAAC7B,GAAG;QAAA,CAAC;QACjC8B,UAAU,EAAE,SAAAA,WAAAC,KAAA;UAAA,IAAGF,IAAI,GAAAE,KAAA,CAAJF,IAAI;UAAA,OACf9C,KAAA,CAACZ,IAAI;YAACoD,KAAK,EAAEC,MAAM,CAACQ,gBAAiB;YAAAV,QAAA,GACjCzC,IAAA,CAACL,KAAK;cAACyD,MAAM,EAAE;gBAAEC,GAAG,EAAEL,IAAI,CAACM;cAAO,CAAE;cAACZ,KAAK,EAAEC,MAAM,CAACY;YAAa,CAAE,CAAC,EACnErD,KAAA,CAACX,IAAI;cAACmD,KAAK,EAAEC,MAAM,CAACa,WAAY;cAAAf,QAAA,GAAEO,IAAI,CAACS,IAAI,EAAC,GAAC;YAAA,CAAM,CAAC,EACpDzD,IAAA,CAACP,gBAAgB;cACbiD,KAAK,EAAEC,MAAM,CAACe,YAAa;cAC3BC,OAAO,EAAE,SAAAA,QAAA;gBAAA,OAAM7B,aAAa,CAACkB,IAAI,CAAC7B,GAAG,CAAC;cAAA,CAAC;cAAAsB,QAAA,EAEvCzC,IAAA,CAACT,IAAI;gBAACmD,KAAK,EAAEC,MAAM,CAACiB,UAAW;gBAAAnB,QAAA,EAAC;cAAM,CAAM;YAAC,CAC/B,CAAC;UAAA,CACjB,CAAC;QAAA;MACT,CACL,CACJ;IAAA,CAEC,CAAC,EACPzC,IAAA,CAACF,UAAU,IAAE,CAAC;EAAA,CAChB,CAAC;AAGX,CAAC;AACD,IAAM6C,MAAM,GAAGjD,UAAU,CAACmE,MAAM,CAAC;EAC7BjB,SAAS,EAAE;IACPkB,IAAI,EAAE,CAAC;IACPC,OAAO,EAAE;EACb,CAAC;EACDlB,MAAM,EAAE;IACJmB,QAAQ,EAAE,EAAE;IACZC,UAAU,EAAE,MAAM;IAClBC,YAAY,EAAE;EAClB,CAAC;EACDf,gBAAgB,EAAE;IACdgB,aAAa,EAAE,KAAK;IACpBC,cAAc,EAAE,eAAe;IAC/BC,UAAU,EAAE,QAAQ;IACpBH,YAAY,EAAE;EAClB,CAAC;EACDV,WAAW,EAAE;IACTQ,QAAQ,EAAE;EACd,CAAC;EACDN,YAAY,EAAE;IACVY,eAAe,EAAE,OAAO;IACxBP,OAAO,EAAE,CAAC;IACVQ,YAAY,EAAE;EAClB,CAAC;EACDC,aAAa,EAAE;IACXF,eAAe,EAAE,KAAK;IACtBP,OAAO,EAAE,CAAC;IACVQ,YAAY,EAAE;EAClB,CAAC;EACDX,UAAU,EAAE;IACRa,KAAK,EAAE,OAAO;IACdR,UAAU,EAAE;EAChB,CAAC;EACDV,YAAY,EAAE;IACVmB,KAAK,EAAE,EAAE;IACTC,MAAM,EAAE,EAAE;IACVJ,YAAY,EAAE;EAClB;AACJ,CAAC,CAAC;AAEF,eAAelE,iBAAiB"},"metadata":{},"sourceType":"module","externalDependencies":[]}